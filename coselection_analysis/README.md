## coselection_analysis

### analyse_spyderpick.py

Identify outlier genes from [Spyderpick](https://github.com/santeripuranen/SpydrPick) analysis. Processes Spyderpick edges files to detect statistically significant gene-gene associations based on mutual information (MI) values. Filters for direct vs indirect associations using ARACNE algorithm and outputs outliers in separate categories (direct/indirect, regular/extreme).

### annotation_to_SHAP_hits.py

Match associated tokens with annotation data. Merges SHAP value outputs from [plot_SHAP.py](plot_SHAP.py) with gene annotation files generated by [annotate_tokens.py](annotate_tokens.py), separating positive and negative SHAP associations and optionally sorting by SHAP value magnitude.

### generate_MSA_from_pa_matrix.py

Generate mock multiple sequence alignment (MSA) from gene presence/absence matrix. Converts binary presence/absence data into FASTA format where 'c' represents gene presence and 'a' represents absence, enabling running of [Spyderpick](https://github.com/santeripuranen/SpydrPick) on pangenome data.

### generate_pa_matrix.py

Generate gene presence/absence matrix from tokenized genomes generated by [WTBCluster](https://github.com/samhorsfield96/WTBcluster). Processes tokenized genome files to create binary matrices showing gene presence (1) or absence (0) across genomes, with options for standard or reversed orientation (genomes as rows vs columns).

### plot_SHAP.py

Plot SHAP (SHapley Additive exPlanations) values from machine learning model outputs. Visualizes feature importance across gene loci, identifies statistical outliers using Tukey's method, and generates plots showing SHAP value distributions with contig boundaries and distance cutoffs.

### plot_SHAP_publication.py

Publication-quality version of SHAP plotting with enhanced visual styling. Creates publication-ready plots with specific color schemes, cleaner outlier visualization, and outputs both PNG and SVG formats for scientific manuscripts.